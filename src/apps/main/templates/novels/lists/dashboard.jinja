{% extends 'global/base.html' %} {% load static %} {% block active_container %}container{% endblock active_container %} {% block content %} {% include 'novels/blocks/confirmation_modal.html' %}

<div class="dashboard">
<form id="dashboard-action-form" method="POST" {% if 'novel_dashboard'%} action="{% url 'novel_dashboard_action' %}" {% else %} action="{% url 'chapter_dashboard_action' %}"{% endif %} hidden> {% csrf_token %} </form>
<div class="dashboard-actions">
    {% if dashboard == 'novel' %}
        <a href="{% url 'new_novel' %}" class="dashboard-action"> <i class="fas fa-plus-square"> </i> Nouveau Roman</a>
    {% elif dashboard == 'chapter'  %}
        <a href="{% url 'new_chapter' novel_id %}" class="dashboard-action"><i class="fas fa-plus-square"></i> Nouveau Chapitre </a>
    {% endif %}

    <div class="dashboard-action-container">
        <input disabled form="dashboard-action-form" id="dashboard-action-submit" value="Valider" type="submit" />
        <select form="dashboard-action-form" id="dashboard-action-select" name="action">
            <option value="publish">Publier</option>
            <option value="unpublish">Depublier</option>
            <option value="delete">Supprimer</option>
        </select>
    </div>
</div>
</div>

<ul class="dashboard-list">
    {% if page_obj %} {% for item in page_obj %}
        <input form="dashboard-action-form" class="dashboard-item-check" type="checkbox" id="check-item-{{ item.id }}" name="selected-items" value="{{ item.id }}" hidden />
        <li class="dashboard-list-item">
            {% if dashboard == 'novel'%}
            <img data-item-id="{{ item.id }}" class="dashboard-item-cover" {% if item.cover %} src="{{ item.cover.url  }}" {% else %} {% endif %} alt=""/>
            {% elif dashboard == 'chapter'%}
            <i class="fas fa-bars"></i>
            <img data-item-id="{{ item.id }}" class="dashboard-item-cover" {% if item.novel.cover %} src="{{ item.novel.cover.url  }}" {% else %} {% endif %} alt=""/>
            {% endif %}
            <p class="dashboard-item-title">{{ item.title }}</p>
            <p class="dashboard-item-public" style="{% if item.public %} color:green; {% else %} color:red; {% endif %}">
            {% if item.public %} Public {% else %} Non-Public {% endif %}
            </p>
            <div class="dashboard-item-actions">
                {% if dashboard == 'novel' %}
                    <a href="{% url 'chapters' item.id %}" class="item-action item-action-chapters"> <i class="fas fa-list-ol"></i> </a>
                    <a href="{% url 'edit_novel' item.id %}" class="item-action item-action-edit">
                        <i class="far fa-edit"></i>
                    </a>
                    <a data-url="{% url 'delete_novel' item.id %}" class="item-action item-action-delete">
                        <i class="fas fa-trash-alt"></i>
                    </a>
                {% elif dashboard == 'chapter' %}
                    <a href="{% url 'edit_chapter' item.id %}" class="item-action item-action-edit">
                        <i class="far fa-edit"></i>
                    </a>
                    <a data-url="{% url 'delete_chapter' item.id %}" class="item-action item-action-delete">
                        <i class="fas fa-trash-alt"></i>
                    </a>
                {% endif %}
            </div>
        </li>
    {% endfor %} {% else %} {% endif %}
</ul>

<div class="dashboard-pagination">
<a {% if page_obj.has_previous %} href="?page=1" class="btn"{% else %} class="btn disabled" {% endif %} >Premier</a>
    <a {% if page_obj.has_previous %} href="?page={{ page_obj.previous_page_number }}" class="btn"{% else %} class="btn disabled" {% endif %} >Precendant</a>
    <div class="dashboard-pagination-indicator">
        {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
    </div>
<a {% if page_obj.has_next %} href="?page={{ page_obj.next_page_number }}" class="btn"{% else %} class="btn disabled" {% endif %} >Suivant</a>
    <a {% if page_obj.has_next %} href="?page={{ page_obj.paginator.num_pages }}" class="btn"{% else %} class="btn disabled" {% endif %} >Dernier</a>
</div>

{% endblock content %}
